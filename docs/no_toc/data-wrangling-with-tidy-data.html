<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Data wrangling with Tidy data | Introduction to R, Season 1</title>
  <meta name="description" content="Chapter 5 Data wrangling with Tidy data | Introduction to R, Season 1" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Data wrangling with Tidy data | Introduction to R, Season 1" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Data wrangling with Tidy data | Introduction to R, Season 1" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/dasl_favicon.ico" type="image/x-icon" />
<link rel="prev" href="functions-and-pipes.html"/>
<link rel="next" href="about-the-authors.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://hutchdatascience.org/" target="_blank"><img src="assets/big-dasl-stacked.png" style="width: 80%; padding-left: 34px; padding-top: 8px;"</a>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this Course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#curriculum"><i class="fa fa-check"></i><b>1.1</b> Curriculum</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#target-audience"><i class="fa fa-check"></i><b>1.2</b> Target Audience</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-to-computing.html"><a href="intro-to-computing.html"><i class="fa fa-check"></i><b>2</b> Intro to Computing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro-to-computing.html"><a href="intro-to-computing.html#goals-of-the-course"><i class="fa fa-check"></i><b>2.1</b> Goals of the course</a></li>
<li class="chapter" data-level="2.2" data-path="intro-to-computing.html"><a href="intro-to-computing.html#what-is-a-computer-program"><i class="fa fa-check"></i><b>2.2</b> What is a computer program?</a></li>
<li class="chapter" data-level="2.3" data-path="intro-to-computing.html"><a href="intro-to-computing.html#a-programming-language-has-following-elements"><i class="fa fa-check"></i><b>2.3</b> A programming language has following elements:</a></li>
<li class="chapter" data-level="2.4" data-path="intro-to-computing.html"><a href="intro-to-computing.html#what-is-r-and-why-should-i-use-it"><i class="fa fa-check"></i><b>2.4</b> What is R and why should I use it?</a></li>
<li class="chapter" data-level="2.5" data-path="intro-to-computing.html"><a href="intro-to-computing.html#r-vs.-python-as-a-first-language"><i class="fa fa-check"></i><b>2.5</b> R vs. Python as a first language</a></li>
<li class="chapter" data-level="2.6" data-path="intro-to-computing.html"><a href="intro-to-computing.html#posit-cloud-setup"><i class="fa fa-check"></i><b>2.6</b> Posit Cloud Setup</a></li>
<li class="chapter" data-level="2.7" data-path="intro-to-computing.html"><a href="intro-to-computing.html#using-quarto-for-your-work"><i class="fa fa-check"></i><b>2.7</b> Using Quarto for your work</a></li>
<li class="chapter" data-level="2.8" data-path="intro-to-computing.html"><a href="intro-to-computing.html#grammar-structure-1-evaluation-of-expressions"><i class="fa fa-check"></i><b>2.8</b> Grammar Structure 1: Evaluation of Expressions</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="intro-to-computing.html"><a href="intro-to-computing.html#data-types"><i class="fa fa-check"></i><b>2.8.1</b> Data types</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="intro-to-computing.html"><a href="intro-to-computing.html#grammar-structure-2-storing-data-types-in-the-global-environment"><i class="fa fa-check"></i><b>2.9</b> Grammar Structure 2: Storing data types in the global environment</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="intro-to-computing.html"><a href="intro-to-computing.html#execution-rule-for-variable-assignment"><i class="fa fa-check"></i><b>2.9.1</b> Execution rule for variable assignment</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="intro-to-computing.html"><a href="intro-to-computing.html#grammar-structure-3-evaluation-of-functions"><i class="fa fa-check"></i><b>2.10</b> Grammar Structure 3: Evaluation of Functions</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="intro-to-computing.html"><a href="intro-to-computing.html#execution-rule-for-functions"><i class="fa fa-check"></i><b>2.10.1</b> Execution rule for functions:</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="intro-to-computing.html"><a href="intro-to-computing.html#tips-on-exercises-debugging"><i class="fa fa-check"></i><b>2.11</b> Tips on Exercises / Debugging</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html"><i class="fa fa-check"></i><b>3</b> Working with data structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#using-operations-on-vectors"><i class="fa fa-check"></i><b>3.1.1</b> Using operations on vectors</a></li>
<li class="chapter" data-level="3.1.2" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#subsetting-vectors-explicitly"><i class="fa fa-check"></i><b>3.1.2</b> Subsetting vectors explicitly</a></li>
<li class="chapter" data-level="3.1.3" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#subsetting-vectors-implicitly"><i class="fa fa-check"></i><b>3.1.3</b> Subsetting vectors implicitly</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#dataframes"><i class="fa fa-check"></i><b>3.2</b> Dataframes</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#using-functions-and-operations-on-dataframes"><i class="fa fa-check"></i><b>3.2.1</b> Using functions and operations on dataframes</a></li>
<li class="chapter" data-level="3.2.2" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#what-do-you-want-to-do-with-this-dataframe"><i class="fa fa-check"></i><b>3.2.2</b> “What do you want to do with this dataframe”?</a></li>
<li class="chapter" data-level="3.2.3" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#filter-rows"><i class="fa fa-check"></i><b>3.2.3</b> Filter rows</a></li>
<li class="chapter" data-level="3.2.4" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#select-columns"><i class="fa fa-check"></i><b>3.2.4</b> Select columns</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html"><i class="fa fa-check"></i><b>4</b> Functions and pipes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#functions-deep-dive"><i class="fa fa-check"></i><b>4.1</b> Functions deep dive</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#anatomy-of-a-function-definition"><i class="fa fa-check"></i><b>4.1.1</b> Anatomy of a function definition</a></li>
<li class="chapter" data-level="4.1.2" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#local-and-global-environments"><i class="fa fa-check"></i><b>4.1.2</b> Local and global environments</a></li>
<li class="chapter" data-level="4.1.3" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#a-step-by-step-example"><i class="fa fa-check"></i><b>4.1.3</b> A step-by-step example</a></li>
<li class="chapter" data-level="4.1.4" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#function-arguments-create-modularity"><i class="fa fa-check"></i><b>4.1.4</b> Function arguments create modularity</a></li>
<li class="chapter" data-level="4.1.5" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#exercises"><i class="fa fa-check"></i><b>4.1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#pipes"><i class="fa fa-check"></i><b>4.2</b> Pipes</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#exercises-1"><i class="fa fa-check"></i><b>4.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#modifying-and-creating-new-columns-in-dataframes"><i class="fa fa-check"></i><b>4.3</b> Modifying and creating new columns in dataframes</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#all-together-now"><i class="fa fa-check"></i><b>4.3.1</b> All together now</a></li>
<li class="chapter" data-level="4.3.2" data-path="functions-and-pipes.html"><a href="functions-and-pipes.html#alternative-creating-and-modifying-columns-via"><i class="fa fa-check"></i><b>4.3.2</b> Alternative: Creating and modifying columns via <code>$</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html"><i class="fa fa-check"></i><b>5</b> Data wrangling with Tidy data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#datasets-within-depmap-project"><i class="fa fa-check"></i><b>5.1</b> Datasets within DepMap Project</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#data-science-workflow"><i class="fa fa-check"></i><b>5.2</b> Data Science Workflow</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#describing-a-tidy-dataset"><i class="fa fa-check"></i><b>5.3</b> Describing a tidy dataset</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#examples-of-tidy-data"><i class="fa fa-check"></i><b>5.3.1</b> Examples of Tidy data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#transform"><i class="fa fa-check"></i><b>5.4</b> Transform</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#the-rows-and-columns-i-need-can-be-subsetted-from-the-dataframe."><i class="fa fa-check"></i><b>5.4.1</b> “The rows and columns I need can be subsetted from the dataframe.”</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#the-column-i-want-is-an-operation-or-function-of-other-columns-i-already-have-in-the-dataframe."><i class="fa fa-check"></i><b>5.4.2</b> “The column I want is an operation or function of other columns I already have in the dataframe.”</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#the-columns-that-i-need-are-in-two-different-dataframes-with-a-common-column.-the-rows-observations-of-both-dataframes-represent-the-same-thing."><i class="fa fa-check"></i><b>5.4.3</b> “The columns that I need are in two different dataframes with a common column. The rows (observations) of both dataframes represent the same thing.”</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#the-rows-i-want-is-described-by-a-column.-the-columns-i-want-need-to-be-summarized-from-other-columns."><i class="fa fa-check"></i><b>5.4.4</b> “The rows I want is described by a column. The columns I want need to be summarized from other columns.”</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-with-tidy-data.html"><a href="data-wrangling-with-tidy-data.html#tidy-data-tutor"><i class="fa fa-check"></i><b>5.5</b> Tidy Data Tutor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
<li class="divider"></li>
<p style="text-align:center;"> <a href="https://github.com/jhudsl/OTTR_Template" target="blank" > This content was published with</a> <a href="https://bookdown.org/" target="blank"> bookdown by: </a> </p>
<p style="text-align:center;"> <a href="https://hutchdatascience.org/"> The Fred Hutch Data Science Lab </a></p>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>
<p style="padding-left: 40px;"><div class="trapezoid" style = "padding-left: 40px;"><span>  <a href="https://forms.gle/W6Mg4rzuMK6Yk3Am8"> Click here to provide feedback</a> <img src="assets/itcr_arrow.png" style=" width: 10%" ></span></div></p>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R, Season 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <!--<script src="assets/hideOutput.js"></script>-->
  <link href="assets/style.css" rel="stylesheet">
</head>
        


<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/dasl_thin_main_image.png">
</div>
<div id="data-wrangling-with-tidy-data" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Data wrangling with Tidy data</h1>
<div id="datasets-within-depmap-project" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Datasets within DepMap Project</h2>
<p>The <a href="https://depmap.org/portal/">Dependency Map project</a> is a multi-omics profiling of cancer cell lines combined with functional assays such as CRISPR and drug sensitivity to help identify cancer vulnerabilities and drug targets. Here are some of the data that we have public access.</p>
<ul>
<li><p>Metadata</p></li>
<li><p>Somatic mutations</p></li>
<li><p>Gene expression</p></li>
<li><p>Drug sensitivity</p></li>
<li><p>CRISPR knockout</p></li>
<li><p>and more…</p></li>
</ul>
</div>
<div id="data-science-workflow" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Data Science Workflow</h2>
<p><img src="https://d33wubrfki0l68.cloudfront.net/571b056757d68e6df81a3e3853f54d3c76ad6efc/32d37/diagrams/data-science.png" width="550" /></p>
<p>We are now equipped with enough fundamental programming skills to apply it to various steps in the data science workflow. We start with <em>Transform</em> and <em>Visualize</em> with the assumption that our data is in a nice, “tidy format”. First, we need to understand what it means for a data to be “tidy”.</p>
</div>
<div id="describing-a-tidy-dataset" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Describing a tidy dataset</h2>
<p>Here, we describe a standard of organizing data. It is important to have standards, as it facilitates a consistent way of thinking about data organization and building tools (functions) that make use of that standard. The principles of <strong>tidy data</strong>, developed by Hadley Wickham:</p>
<ol style="list-style-type: decimal">
<li><p>Each variable must have its own column.</p></li>
<li><p>Each observation must have its own row.</p></li>
<li><p>Each value must have its own cell.</p></li>
</ol>
<p>If you want to be technical about what variables and observations are, Hadley Wickham describes:</p>
<blockquote>
<p>A <strong>variable</strong> contains all values that measure the same underlying attribute (like height, temperature, duration) across units. An <strong>observation</strong> contains all values measured on the same unit (like a person, or a day, or a race) across attributes.</p>
</blockquote>
<div class="figure">
<img src="https://r4ds.hadley.nz/images/tidy-1.png" width="800" alt="" />
<p class="caption">A tidy dataframe.</p>
</div>
<div id="examples-of-tidy-data" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Examples of Tidy data</h3>
<p>Let’s practice describing the observations, variables, and values of tidy dataframes:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="data-wrangling-with-tidy-data.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## Warning: package &#39;tidyverse&#39; was built under R version 4.0.3</code></pre>
<pre><code>## Warning: package &#39;purrr&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Warning: package &#39;stringr&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="data-wrangling-with-tidy-data.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb101-2"><a href="data-wrangling-with-tidy-data.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">&quot;https://github.com/caalo/Intro_to_R/raw/main/classroom_data/CCLE.RData&quot;</span>))</span></code></pre></div>
<table>
<colgroup>
<col width="24%" />
<col width="24%" />
<col width="27%" />
<col width="24%" />
</colgroup>
<thead>
<tr class="header">
<th>Dataframe</th>
<th>The observation is</th>
<th>Some variables are</th>
<th>Some values are</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>metadata</td>
<td>Cell line</td>
<td>ModelID, Age, OncotreeLineage</td>
<td>“ACH-000001”, 60, “Myeloid”</td>
</tr>
<tr class="even">
<td>expression</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>mutation</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>penguins</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>table1</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="transform" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Transform</h2>
<p>When given a tidy dataset, we often still have to do some transformations on it to get it in a form so that we can perforom our analysis and visualization. Here are some common transformation tasks:</p>
<div id="the-rows-and-columns-i-need-can-be-subsetted-from-the-dataframe." class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> “The rows and columns I need can be subsetted from the dataframe.”</h3>
<p>We use <code>filter()</code> and <code>select()</code> as we have learned already.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="data-wrangling-with-tidy-data.html#cb102-1" aria-hidden="true" tabindex="-1"></a>breast_metadata <span class="ot">=</span> metadata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(OncotreeLineage <span class="sc">==</span> <span class="st">&quot;Breast&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="data-wrangling-with-tidy-data.html#cb102-2" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">select</span>(ModelID, Age, Sex)</span></code></pre></div>
</div>
<div id="the-column-i-want-is-an-operation-or-function-of-other-columns-i-already-have-in-the-dataframe." class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> “The column I want is an operation or function of other columns I already have in the dataframe.”</h3>
<p>We use <code>mutate()</code> or <code>$</code> operation as we have learned already.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="data-wrangling-with-tidy-data.html#cb103-1" aria-hidden="true" tabindex="-1"></a>expression <span class="ot">=</span> expression <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">log_PIK3CA_Exp =</span> <span class="fu">log</span>(PIK3CA_Exp))</span>
<span id="cb103-2"><a href="data-wrangling-with-tidy-data.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co">#or</span></span>
<span id="cb103-3"><a href="data-wrangling-with-tidy-data.html#cb103-3" aria-hidden="true" tabindex="-1"></a>expression<span class="sc">$</span>log_PIK3CA_Exp <span class="ot">=</span> <span class="fu">log</span>(expression<span class="sc">$</span>PIK3CA_Exp)</span></code></pre></div>
</div>
<div id="the-columns-that-i-need-are-in-two-different-dataframes-with-a-common-column.-the-rows-observations-of-both-dataframes-represent-the-same-thing." class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> “The columns that I need are in two different dataframes with a common column. The rows (observations) of both dataframes represent the same thing.”</h3>
<p>Suppose we have the following dataframes:</p>
<p><code>expression</code></p>
<table>
<thead>
<tr class="header">
<th>ModelID</th>
<th>PIK3CA_Exp</th>
<th>log_PIK3CA_Exp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“ACH-001113”</td>
<td>5.138733</td>
<td>1.636806</td>
</tr>
<tr class="even">
<td>“ACH-001289”</td>
<td>3.184280</td>
<td>1.158226</td>
</tr>
<tr class="odd">
<td>“ACH-001339”</td>
<td>3.165108</td>
<td>1.152187</td>
</tr>
</tbody>
</table>
<p><code>metadata</code></p>
<table>
<thead>
<tr class="header">
<th>ModelID</th>
<th>OncotreeLineage</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“ACH-001113”</td>
<td>“Lung”</td>
<td>69</td>
</tr>
<tr class="even">
<td>“ACH-001289”</td>
<td>“CNS/Brain”</td>
<td>NA</td>
</tr>
<tr class="odd">
<td>“ACH-001339”</td>
<td>“Skin”</td>
<td>14</td>
</tr>
</tbody>
</table>
<p>Suppose that I want to compare the relationship between <code>OncotreeLineage</code> and <code>PIK3CA_Exp</code>, but they are columns in different dataframes. We want a new dataframe that looks like this:</p>
<table>
<thead>
<tr class="header">
<th>ModelID</th>
<th>PIK3CA_Exp</th>
<th>log_PIK3CA_Exp</th>
<th>OncotreeLineage</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“ACH-001113”</td>
<td>5.138733</td>
<td>1.636806</td>
<td>“Lung”</td>
<td>69</td>
</tr>
<tr class="even">
<td>“ACH-001289”</td>
<td>3.184280</td>
<td>1.158226</td>
<td>“CNS/Brain”</td>
<td>NA</td>
</tr>
<tr class="odd">
<td>“ACH-001339”</td>
<td>3.165108</td>
<td>1.152187</td>
<td>“Skin”</td>
<td>14</td>
</tr>
</tbody>
</table>
<p>We see that in both dataframes, the rows (observations) represent cell lines with a common column <code>ModelID</code>, so let’s merge these two dataframes together, using <code>full_join()</code>:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="data-wrangling-with-tidy-data.html#cb104-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">=</span> <span class="fu">full_join</span>(metadata, expression, <span class="at">by =</span> <span class="st">&quot;ModelID&quot;</span>)</span></code></pre></div>
<p>The number of rows and columns of <code>metadata</code>:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="data-wrangling-with-tidy-data.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metadata)</span></code></pre></div>
<pre><code>## [1] 1864   30</code></pre>
<p>The number of rows and columns of <code>expression</code>:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="data-wrangling-with-tidy-data.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(expression)</span></code></pre></div>
<pre><code>## [1] 1450  537</code></pre>
<p>The number of rows and columns of <code>merged</code>:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="data-wrangling-with-tidy-data.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged)</span></code></pre></div>
<pre><code>## [1] 1864  566</code></pre>
<p>We see that the number of <em>columns</em> in <code>merged</code> combines the number of columns in <code>metadata</code> and <code>expression</code>, while the number of <em>rows</em> in <code>merged</code> is the larger of the number of rows in <code>metadata</code> and <code>expression</code> : <code>full_join()</code> keeps all observations common to both dataframes based on the common column defined via the <code>by</code> argument.</p>
<p>Therefore, we expect to see <code>NA</code> values in <code>merged</code>, as there are some cell lines that are not in <code>expression</code> dataframe.</p>
<p>There are variations of this function depending on your application:</p>
<p><img src="images/join.png" /></p>
<p>Given <code>xxx_join(x, y, by = "common_col")</code>,</p>
<ul>
<li><p><code>full_join()</code> keeps all observations.</p></li>
<li><p><code>left_join()</code> keeps all observations in <code>x</code>.</p></li>
<li><p><code>right_join()</code> keeps all observations in <code>y</code>.</p></li>
<li><p><code>inner_join()</code> keeps observations common to both <code>x</code> and <code>y</code>.</p></li>
</ul>
</div>
<div id="the-rows-i-want-is-described-by-a-column.-the-columns-i-want-need-to-be-summarized-from-other-columns." class="section level3" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> “The rows I want is described by a column. The columns I want need to be summarized from other columns.”</h3>
<p>In a dataset, there may be multiple levels of observations, and which level of observation we examine depends on our scientific question. For instance, in <code>metadata</code>, the observation is cell lines. However, perhaps we want to understand properties of <code>metadata</code> in which the observation is the cancer type, <code>OncotreeLineage</code>. Suppose we want the mean age of each cancer type, and the number of cell lines that we have for each cancer type. This is a scenario in which the <em>desired rows are described by a column</em>, <code>OncotreeLineage</code>, and the columns, such as mean age, need to be summarized from other columns.</p>
<p>As an example, this dataframe is transformed from:</p>
<table>
<thead>
<tr class="header">
<th>ModelID</th>
<th>OncotreeLineage</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“ACH-001113”</td>
<td>“Lung”</td>
<td>69</td>
</tr>
<tr class="even">
<td>“ACH-001289”</td>
<td>“Lung”</td>
<td>23</td>
</tr>
<tr class="odd">
<td>“ACH-001339”</td>
<td>“Skin”</td>
<td>14</td>
</tr>
<tr class="even">
<td>“ACH-002342”</td>
<td>“Brain”</td>
<td>23</td>
</tr>
<tr class="odd">
<td>“ACH-004854”</td>
<td>“Brain”</td>
<td>56</td>
</tr>
<tr class="even">
<td>“ACH-002921”</td>
<td>“Brain”</td>
<td>67</td>
</tr>
</tbody>
</table>
<p>into:</p>
<table>
<thead>
<tr class="header">
<th>OncotreeLineage</th>
<th>MeanAge</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“Lung”</td>
<td>46</td>
<td>2</td>
</tr>
<tr class="even">
<td>“Skin”</td>
<td>14</td>
<td>1</td>
</tr>
<tr class="odd">
<td>“Brain”</td>
<td>48.67</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>We use the functions <code>group_by()</code> and <code>summarise()</code> :</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="data-wrangling-with-tidy-data.html#cb111-1" aria-hidden="true" tabindex="-1"></a>metadata_by_type <span class="ot">=</span> metadata <span class="sc">%&gt;%</span> </span>
<span id="cb111-2"><a href="data-wrangling-with-tidy-data.html#cb111-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">group_by</span>(OncotreeLineage) <span class="sc">%&gt;%</span> </span>
<span id="cb111-3"><a href="data-wrangling-with-tidy-data.html#cb111-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">summarise</span>(<span class="at">MeanAge =</span> <span class="fu">mean</span>(Age),</span>
<span id="cb111-4"><a href="data-wrangling-with-tidy-data.html#cb111-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Count =</span> <span class="fu">n</span>())</span></code></pre></div>
<p>The <code>group_by()</code> function returns the identical input dataframe but remembers which variable(s) have been marked as grouped.</p>
<p>The <code>summarise()</code> returns one row for each combination of grouping variables, and one column for each of the summary statistics that you have specified.</p>
</div>
</div>
<div id="tidy-data-tutor" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Tidy Data Tutor</h2>
<p>Guest speaker: <a href="https://seankross.com/">Sean Kross</a>, author of <a href="https://tidydatatutor.com/">Tidy Data Tutor</a>.</p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
      <a href="https://hutchdatascience.org/" target="_blank"><img src="https://hutchdatascience.org/images/crazy-idea-wide.png" style="width: 80%; padding-left: 15px; padding-top: 8px;"</a>
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="functions-and-pipes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="about-the-authors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
